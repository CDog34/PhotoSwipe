!function(e,t){"function"==typeof define&&define.amd?define(t):"object"==typeof exports?module.exports=t():e.PhotoSwipeUI_Default=t()}(this,function(){"use strict";return function(r,s){function e(e){if(F)return!0;e=e||window.event,E.timeToIdle&&E.mouseUsed&&!v&&D();for(var t,n,o=(e.target||e.srcElement).getAttribute("class")||"",r=0;r<P.length;r++)(t=P[r]).onTap&&-1<o.indexOf("pswp__"+t.name)&&(t.onTap(),n=!0);if(n){e.stopPropagation&&e.stopPropagation(),F=!0;var l=s.features.isOldAndroid?600:30;setTimeout(function(){F=!1},l)}}function n(e,t,n){s[(n?"add":"remove")+"Class"](e,"pswp__"+t)}function t(){var e=1===E.getNumItemsFn();e!==I&&(n(p,"ui--one-slide",e),I=e)}function o(){n(w,"share-modal--hidden",O)}function l(){return(O=!O)?(s.removeClass(w,"pswp__share-modal--fade-in"),setTimeout(function(){O&&o()},300)):(o(),setTimeout(function(){O||s.addClass(w,"pswp__share-modal--fade-in")},30)),O||z(),!1}function i(e){var t=(e=e||window.event).target||e.srcElement;return r.shout("shareLinkClick",e,t),!!t.href&&(!!t.hasAttribute("download")||(window.open(t.href,"pswp_share","scrollbars=yes,resizable=yes,toolbar=no,location=yes,width=550,height=420,top=100,left="+(window.screen?Math.round(screen.width/2-275):100)),O||l(),!1))}function a(e){for(var t=0;t<E.closeElClasses.length;t++)if(s.hasClass(e,"pswp__"+E.closeElClasses[t]))return!0}function u(e){var t=(e=e||window.event).relatedTarget||e.toElement;t&&"HTML"!==t.nodeName||(clearTimeout(k),k=setTimeout(function(){K.setIdle(!0)},E.timeToIdleOutside))}function c(e){var t=e.vGap;if(!r.likelyTouchDevice||E.mouseUsed||screen.width>E.fitControlsWidth){var n=E.barsSize;if(E.captionEl&&"auto"===n.bottom)if(f||((f=s.createEl("pswp__caption pswp__caption--fake")).appendChild(s.createEl("pswp__caption__center")),p.insertBefore(f,m),s.addClass(p,"pswp__ui--fit")),E.addCaptionHTMLFn(e,f,!0)){var o=f.clientHeight;t.bottom=parseInt(o,10)||44}else t.bottom=n.top;else t.bottom="auto"===n.bottom?0:n.bottom;t.top=n.top}else t.top=t.bottom=0}var d,p,m,f,h,w,g,v,b,_,C,T,I,E,F,x,S,k,K=this,L=!1,y=!0,O=!0,R={barsSize:{top:44,bottom:"auto"},closeElClasses:["item","caption","zoom-wrap","ui","top-bar"],timeToIdle:4e3,timeToIdleOutside:1e3,loadingIndicatorDelay:1e3,addCaptionHTMLFn:function(e,t){return e.title?(t.children[0].innerHTML=e.title,!0):(t.children[0].innerHTML="",!1)},closeEl:!0,captionEl:!0,fullscreenEl:!0,zoomEl:!0,shareEl:!0,counterEl:!0,arrowEl:!0,preloaderEl:!0,rotateEl:!0,tapToClose:!1,tapToToggleControls:!0,clickToCloseNonZoomable:!0,shareButtons:[{id:"facebook",label:"Share on Facebook",url:"https://www.facebook.com/sharer/sharer.php?u={{url}}"},{id:"twitter",label:"Tweet",url:"https://twitter.com/intent/tweet?text={{text}}&url={{url}}"},{id:"pinterest",label:"Pin it",url:"http://www.pinterest.com/pin/create/button/?url={{url}}&media={{image_url}}&description={{text}}"},{id:"download",label:"Download image",url:"{{raw_image_url}}",download:!0}],getImageURLForShare:function(){return r.currItem.src||""},getPageURLForShare:function(){return window.location.href},getTextForShare:function(){return r.currItem.title||""},indexIndicatorSep:" / ",fitControlsWidth:1200},z=function(){for(var e,t,n,o,r="",l=0;l<E.shareButtons.length;l++)e=E.shareButtons[l],t=E.getImageURLForShare(e),n=E.getPageURLForShare(e),o=E.getTextForShare(e),r+='<a href="'+e.url.replace("{{url}}",encodeURIComponent(n)).replace("{{image_url}}",encodeURIComponent(t)).replace("{{raw_image_url}}",t).replace("{{text}}",encodeURIComponent(o))+'" target="_blank" class="pswp__share--'+e.id+'"'+(e.download?"download":"")+">"+e.label+"</a>",E.parseShareButtonOut&&(r=E.parseShareButtonOut(e,r));w.children[0].innerHTML=r,w.children[0].onclick=i},M=0,D=function(){clearTimeout(k),M=0,v&&K.setIdle(!1)},A=function(e){C!==e&&(n(_,"preloader--active",!e),C=e)},P=[{name:"caption",option:"captionEl",onInit:function(e){m=e}},{name:"share-modal",option:"shareEl",onInit:function(e){w=e},onTap:function(){l()}},{name:"button--rotate",option:"rotateEl",onTap:function(){var e=r.currItem,t=e.container.querySelector("img.pswp__img");if(t){e.rotate||(e.rotate=0),e.rotate=e.rotate+90,clearTimeout(x),s.addClass(t,"ts-key");var n=s.features.transform;t.style[n]="rotate("+e.rotate+"deg)",360<=e.rotate&&(clearTimeout(x),x=setTimeout(function(){s.removeClass(t,"ts-key"),e.rotate=e.rotate%360,t.style[n]="rotate("+e.rotate+"deg)"},333))}}},{name:"button--zoom",option:"zoomEl",onTap:r.toggleDesktopZoom},{name:"counter",option:"counterEl",onInit:function(e){h=e}},{name:"button--close",option:"closeEl",onTap:r.close},{name:"button--arrow--left",option:"arrowEl",onTap:r.prev},{name:"button--arrow--right",option:"arrowEl",onTap:r.next},{name:"button--fs",option:"fullscreenEl",onTap:function(){d.isFullscreen()?d.exit():d.enter()}},{name:"preloader",option:"preloaderEl",onInit:function(e){_=e}}];K.init=function(){s.extend(r.options,R,!0),E=r.options,p=s.getChildByClass(r.scrollWrap,"pswp__ui"),b=r.listen,function(){var t;b("onVerticalDrag",function(e){y&&e<.95?K.hideControls():!y&&.95<=e&&K.showControls()}),b("onPinchClose",function(e){y&&e<.9?(K.hideControls(),t=!0):t&&!y&&.9<e&&K.showControls()}),b("zoomGestureEnded",function(){(t=!1)&&!y&&K.showControls()})}(),b("beforeChange",K.update),b("doubleTap",function(e){var t=r.currItem.initialZoomLevel;r.getZoomLevel()!==t?r.zoomTo(t,e,333):r.zoomTo(E.getDoubleTapZoom(!1,r.currItem),e,333)}),b("preventDragEvent",function(e,t,n){var o=e.target||e.srcElement;o&&o.getAttribute("class")&&-1<e.type.indexOf("mouse")&&(0<o.getAttribute("class").indexOf("__caption")||/(SMALL|STRONG|EM)/i.test(o.tagName))&&(n.prevent=!1)}),b("bindEvents",function(){s.bind(p,"pswpTap click",e),s.bind(r.scrollWrap,"pswpTap",K.onGlobalTap),r.likelyTouchDevice||s.bind(r.scrollWrap,"mouseover",K.onMouseOver)}),b("unbindEvents",function(){O||l(),S&&clearInterval(S),s.unbind(document,"mouseout",u),s.unbind(document,"mousemove",D),s.unbind(p,"pswpTap click",e),s.unbind(r.scrollWrap,"pswpTap",K.onGlobalTap),s.unbind(r.scrollWrap,"mouseover",K.onMouseOver),d&&(s.unbind(document,d.eventK,K.updateFullscreen),d.isFullscreen()&&(E.hideAnimationDuration=0,d.exit()),d=null)}),b("destroy",function(){E.captionEl&&(f&&p.removeChild(f),s.removeClass(m,"pswp__caption--empty")),w&&(w.children[0].onclick=null),s.removeClass(p,"pswp__ui--over-close"),s.addClass(p,"pswp__ui--hidden"),K.setIdle(!1)}),E.showAnimationDuration||s.removeClass(p,"pswp__ui--hidden"),b("initialZoomIn",function(){E.showAnimationDuration&&s.removeClass(p,"pswp__ui--hidden")}),b("initialZoomOut",function(){s.addClass(p,"pswp__ui--hidden")}),b("parseVerticalMargin",c),function(){function e(e){if(e)for(var t=e.length,n=0;n<t;n++){r=e[n],l=r.className;for(var o=0;o<P.length;o++)i=P[o],-1<l.indexOf("pswp__"+i.name)&&(E[i.option]?(s.removeClass(r,"pswp__element--disabled"),i.onInit&&i.onInit(r)):s.addClass(r,"pswp__element--disabled"))}}var r,l,i;e(p.children);var t=s.getChildByClass(p,"pswp__top-bar");t&&e(t.children)}(),E.shareEl,t(),E.timeToIdle&&b("mouseUsed",function(){s.bind(document,"mousemove",D),s.bind(document,"mouseout",u),S=setInterval(function(){2==++M&&K.setIdle(!0)},E.timeToIdle/2)}),E.fullscreenEl&&!s.features.isOldAndroid&&(d||(d=K.getFullscreenAPI()),d?(s.bind(document,d.eventK,K.updateFullscreen),K.updateFullscreen(),s.addClass(r.template,"pswp--supports-fs")):s.removeClass(r.template,"pswp--supports-fs")),E.preloaderEl&&(A(!0),b("beforeChange",function(){clearTimeout(T),T=setTimeout(function(){r.currItem&&r.currItem.loading?r.allowProgressiveImg()&&(!r.currItem.img||r.currItem.img.naturalWidth)||A(!1):A(!0)},E.loadingIndicatorDelay)}),b("imageLoadComplete",function(e,t){r.currItem===t&&A(!0)}))},K.setIdle=function(e){n(p,"ui--idle",v=e)},K.update=function(){L=!(!y||!r.currItem)&&(K.updateIndexIndicator(),E.captionEl&&(E.addCaptionHTMLFn(r.currItem,m),n(m,"caption--empty",!r.currItem.title)),!0),O||l(),t()},K.updateFullscreen=function(e){e&&setTimeout(function(){r.setScrollOffset(0,s.getScrollY())},50),s[(d.isFullscreen()?"add":"remove")+"Class"](r.template,"pswp--fs")},K.updateIndexIndicator=function(){E.counterEl&&(h.innerHTML=r.getCurrentIndex()+1+E.indexIndicatorSep+E.getNumItemsFn())},K.onGlobalTap=function(e){var t=(e=e||window.event).target||e.srcElement;if(!F)if(e.detail&&"mouse"===e.detail.pointerType){if(a(t))return void r.close();s.hasClass(t,"pswp__img")&&(1===r.getZoomLevel()&&r.getZoomLevel()<=r.currItem.fitRatio?E.clickToCloseNonZoomable&&r.close():r.toggleDesktopZoom(e.detail.releasePoint))}else if(E.tapToToggleControls&&(y?K.hideControls():K.showControls()),E.tapToClose&&(s.hasClass(t,"pswp__img")||a(t)))return void r.close()},K.onMouseOver=function(e){var t=(e=e||window.event).target||e.srcElement;n(p,"ui--over-close",a(t))},K.hideControls=function(){s.addClass(p,"pswp__ui--hidden"),y=!1},K.showControls=function(){y=!0,L||K.update(),s.removeClass(p,"pswp__ui--hidden")},K.supportsFullscreen=function(){var e=document;return!!(e.exitFullscreen||e.mozCancelFullScreen||e.webkitExitFullscreen||e.msExitFullscreen)},K.getFullscreenAPI=function(){var e,t=document.documentElement,n="fullscreenchange";return t.requestFullscreen?e={enterK:"requestFullscreen",exitK:"exitFullscreen",elementK:"fullscreenElement",eventK:n}:t.mozRequestFullScreen?e={enterK:"mozRequestFullScreen",exitK:"mozCancelFullScreen",elementK:"mozFullScreenElement",eventK:"moz"+n}:t.webkitRequestFullscreen?e={enterK:"webkitRequestFullscreen",exitK:"webkitExitFullscreen",elementK:"webkitFullscreenElement",eventK:"webkit"+n}:t.msRequestFullscreen&&(e={enterK:"msRequestFullscreen",exitK:"msExitFullscreen",elementK:"msFullscreenElement",eventK:"MSFullscreenChange"}),e&&(e.enter=function(){if(g=E.closeOnScroll,E.closeOnScroll=!1,"webkitRequestFullscreen"!==this.enterK)return r.template[this.enterK]();r.template[this.enterK](Element.ALLOW_KEYBOARD_INPUT)},e.exit=function(){return E.closeOnScroll=g,document[this.exitK]()},e.isFullscreen=function(){return document[this.elementK]}),e}}});